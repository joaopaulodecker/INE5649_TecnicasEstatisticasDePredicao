install.packages("ggplot2")
oi = 33
lista => (3, 4, 5 , 6)
setwd("~/Desktop/UFSC/Semestres/3º semestre/Técnicas Estatísticas de Predição/Exercicios/Exercicio4")
# Amostra
base = read.csv2("selecao.csv")
set.seed(07052006) # COLOQUE O SEU DIA MÊS E ANO DE NASCIMENTO NA SET.SEED
base1 = base[sample(nrow(base), 500),]
View(base1)
# Seleção de variáveis - método backward
modelo_completo <- lm(Valor ~ ., data = base1)
modelo_backward <- step(modelo_completo, direction = "backward")
View(base1)
# Seleção de variáveis - método backward
mc=lm( y ~ ., data=base)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# c - Análise de resíduos
plot(fitted(modelo_backward), rstandard(modelo_backward),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
# c - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
# QQ-plot
qqnorm(rstandard(backward_model))
# a - Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# b - Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# c - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
# QQ-plot
qqnorm(rstandard(backward_model))
qqline(rstandard(backward_model), col = "red", lwd = 2)
# Modelo com transformação logarítmica
modelo_log <- lm(log(Y) ~ ., data = base1)
# Modelo com transformação logarítmica
modelo_log <- lm(log(y) ~ ., data = base1)
modelo_log_backward <- step(modelo_log, direction = "backward")
summary(modelo_log_backward)
# Análise de resíduos novamente
plot(fitted(modelo_log_backward), rstandard(modelo_log_backward),
main = "Gráfico de Resíduos - Modelo com log(Valor)",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
modelo_poly <- lm(y ~ I(Area^2) + I(Quartos^2) + ., data = base1)
View(base1)
View(base1)
modelo_poly <- lm(y ~ I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + I(x5^2) + I(x6^2) + I(x7^2) + I(x8^2) + I(x9^2) + I(x10^2), data = base1)
modelo_poly_backward <- step(modelo_poly, direction = "backward")
summary(modelo_poly_backward)
plot(fitted(modelo_poly_backward), rstandard(modelo_poly_backward),
main = "Resíduos - Modelo com Termos Quadráticos",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# A - Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# B - Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# C - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
# QQ-plot
qqnorm(rstandard(backward_model))
qqline(rstandard(backward_model), col = "red", lwd = 2)
modelo_poly <- lm(y ~ I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + I(x5^2) + I(x6^2) + I(x7^2) + I(x8^2) + I(x9^2) + I(x10^2), data = base1)
modelo_poly_backward <- step(modelo_poly, direction = "backward")
summary(modelo_poly_backward)
plot(fitted(modelo_poly_backward), rstandard(modelo_poly_backward),
main = "Resíduos - Modelo com Termos Quadráticos",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# A - Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# B - Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# C - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
modelo_log = lm(log(y) ~ ., data = base1)
backward_log = step(modelo_log, direction = "backward")
summary(backward_log)
# Análise de resíduos do modelo com log(y)
plot(fitted(backward_log), rstandard(backward_log),
main = "Gráfico de Resíduos - Modelo com log(y)",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_log),
main = "Histograma dos Resíduos Padronizados - log(y)",
xlab = "Resíduo Padronizado",
col = "skyblue")
# E - Inclusão de termos quadráticos (transformação polinomial)
modelo_poly = lm(y ~ . + I(x1^2) + I(x2^2), data = base1)
backward_poly = step(modelo_poly, direction = "backward")
summary(backward_poly)
# Análise de resíduos do modelo com termos quadráticos
plot(fitted(backward_poly), rstandard(backward_poly),
main = "Gráfico de Resíduos - Modelo com termos quadráticos",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_poly),
main = "Histograma dos Resíduos Padronizados - Modelo Polinomial",
xlab = "Resíduo Padronizado",
col = "skyblue")
# F - Transformação Box-Cox
library(MASS)
# Calcula a transformação Box-Cox para o modelo atual
boxcox(backward_model)
# Escolhe o lambda (λ) que maximiza a verossimilhança
bc = boxcox(backward_model)
lambda = bc$x[which.max(bc$y)]
lambda
# G - Reajuste do modelo com a transformação sugerida
if (lambda > 0 & lambda != 1) {
base1$y_bc = (base1$y ^ lambda - 1) / lambda
} else if (lambda == 0) {
base1$y_bc = log(base1$y)
} else {
base1$y_bc = (base1$y ^ lambda - 1) / lambda
}
# Novo modelo com a variável transformada
modelo_bc = lm(y_bc ~ ., data = base1)
backward_bc = step(modelo_bc, direction = "backward")
summary(backward_bc)
# Análise dos resíduos do modelo Box-Cox
plot(fitted(backward_bc), rstandard(backward_bc),
main = "Gráfico de Resíduos - Modelo Box-Cox",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
hist(rstandard(backward_bc),
main = "Histograma dos Resíduos Padronizados - Box-Cox",
xlab = "Resíduo Padronizado",
col = "skyblue")
# H - Modelo com interações de 2ª ordem
modelo_interacao = lm(y ~ .^2, data = base1)
backward_interacao = step(modelo_interacao, direction = "backward")
summary(backward_interacao)
# Análise de resíduos
plot(fitted(backward_interacao), rstandard(backward_interacao),
main = "Gráfico de Resíduos - Modelo com Interações",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
hist(rstandard(backward_interacao),
main = "Histograma dos Resíduos Padronizados - Modelo com Interações",
xlab = "Resíduo Padronizado",
col = "skyblue")
# A - Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# B - Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# C - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
View(base1)
# backward com variaveis quadraticas
mcq=lm( y ~ x1, x2,x3, x4, x5, x6, x7, x8, x9, x10, I(x1)ˆ2, I(x2)ˆ2, I(x3)ˆ2, I(x4)ˆ2, I(x5)ˆ2, I(x6)ˆ2, I(x7)ˆ2, I(x8)ˆ2, I(x9)ˆ2, I(x10)ˆ2, data=base1)
# backward com variáveis quadráticas
mcq = lm(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + I(x5^2) +
I(x6^2) + I(x7^2) + I(x8^2) + I(x9^2) + I(x10^2),
data = base1)
backward_model_quad = step(mcq, direction = "backward")
summary(backward_model_quad)
# C - Análise de resíduos
plot(fitted(backward_model_quad), rstandard(backward_model_quad),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model_quad),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
# A - Amostra
base = read.csv2("selecao.csv")
set.seed(07052006)
base1 = base[sample(nrow(base), 500),]
# B - Seleção de variáveis - método backward
mc=lm( y ~ ., data=base1)
backward_model=step(mc, direction = "backward")
summary(backward_model)
# C - Análise de resíduos
plot(fitted(backward_model), rstandard(backward_model),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
# backward com variáveis quadráticas
mcq = lm(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + I(x5^2) +
I(x6^2) + I(x7^2) + I(x8^2) + I(x9^2) + I(x10^2),
data = base1)
backward_model_quad = step(mcq, direction = "backward")
summary(backward_model_quad)
#  Análise de resíduos
plot(fitted(backward_model_quad), rstandard(backward_model_quad),
main = "Gráfico de Resíduos do Modelo Original",
xlab = "Valores Ajustados",
ylab = "Resíduos Padronizados")
abline(h = 0, col = "red")
# Histograma dos resíduos
hist(rstandard(backward_model_quad),
main = "Histograma dos Resíduos Padronizados",
xlab = "Resíduo Padronizado",
col = "skyblue")
mcq2 = lm(y ~ . + I(.^2),
data = base1)
