install.packages("ggplot2")
oi = 33
lista => (3, 4, 5 , 6)
library(ggplot2)
# Exemplo de dados simulados
set.seed(1)
dados <- data.frame(
Experiencia = rep(1:10, each = 2),
Sexo = rep(c("Feminino", "Masculino"), times = 10)
)
dados$Salario <- 2000 + 500*dados$Experiencia +
ifelse(dados$Sexo == "Masculino", 1000 + 200*dados$Experiencia, 0) +
rnorm(20, 0, 300)
# Plotando
ggplot(dados, aes(x = Experiencia, y = Salario, color = Sexo)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_minimal() +
labs(title = "Interação entre Experiência e Sexo no Salário",
y = "Salário (R$)",
x = "Anos de Experiência")
ggplot(dados, aes(x=Experiencia, y=Salario, color=Sexo)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
setwd("~/Desktop/UFSC/Semestres/3º semestre/Técnicas Estatísticas de Predição")
setwd("~/Desktop/UFSC/Semestres/3º semestre/Técnicas Estatísticas de Predição/Exercicios/Exercicio5")
library(tidyverse)
install.packages("tidyverse")
install.packages("lubridate")
library(tidyverse)
library(lubridate)
library(lubridate)
# Ler os dados
gold <- read_csv("GoldUP.csv", show_col_types = FALSE)
library(tidyverse)
library(tidyverse)
library(lubridate)
gold <- read_csv("GoldUP.csv", show_col_types = FALSE)
problems(gold)
library(tidyverse)
library(lubridate)
gold <- read_csv2("GoldUP.csv", show_col_types = FALSE)
View(gold)
gold <- gold %>%
mutate(Date = ymd(Date)) %>%
arrange(Date)
indice_teste <- tail(1:nrow(gold), 12)
treino <- gold[-indice_teste, ]
teste  <- gold[indice_teste, ]
View(gold)
library(tidyverse)
library(tidyverse)
library(forecast)
library(lubridate)
gold <- read_csv2("GoldUP.csv", show_col_types = FALSE)
indice_teste <- tail(1:nrow(gold), 12)   # últimos 12 meses (2024)
treino <- gold[-indice_teste, ]          # até dez/2023
teste  <- gold[indice_teste, ]           # jan–dez/2024
base_ts <- ts(treino$Gold_Price, frequency = 12, start = c(2015, 1))
autoplot(base_ts) +
labs(title = "Preço do Ouro (USD/oz)", x = "Ano", y = "USD/oz")
modelo_reg <- lm(Gold_Price ~ Crude_Oil + Interest_Rate + USD_INR + CPI,
data = treino)
summary(modelo_reg)
# Previsão com o modelo de regressão
prev_reg <- predict(modelo_reg, newdata = teste)
SES <- ses(base_ts, h = 12)
HOLT <- holt(base_ts, h = 12)
HW_ad <- hw(base_ts, seasonal = "additive", h = 12)
HW_mult <- hw(base_ts, seasonal = "multiplicative", h = 12)
ETS <- ets(base_ts)
ETS_pred <- forecast(ETS, h = 12)
teste <- cbind(
teste,
SES = SES$mean,
HOLT = HOLT$mean,
HW_ad = HW_ad$mean,
HW_mult = HW_mult$mean,
ETS = ETS_pred$mean,
REG = prev_reg
)
teste$Date <- as.Date(teste$Date)
ggplot(teste, aes(x = Date)) +
geom_line(aes(y = Gold_Price, color = "Real"), linetype = "solid") +
geom_line(aes(y = SES, color = "SES"), linetype = "dashed") +
geom_line(aes(y = HOLT, color = "Holt"), linetype = "solid") +
geom_line(aes(y = HW_ad, color = "HW Aditivo"), linetype = "dashed") +
geom_line(aes(y = HW_mult, color = "HW Multiplicativo"), linetype = "solid") +
geom_line(aes(y = ETS, color = "ETS"), linetype = "solid") +
geom_line(aes(y = REG, color = "Regressão Linear"), linetype = "dashed") +
scale_color_manual(name = "Modelos",
values = c("Real" = "black", "SES" = "blue", "Holt" = "green",
"HW Aditivo" = "orange", "HW Multiplicativo" = "purple",
"ETS" = "red", "Regressão Linear" = "brown")) +
theme_bw() +
labs(title = "Previsões do preço do ouro (jan–dez/2024)",
x = "Data", y = "USD/oz") +
theme(legend.position = "bottom")
eam <- function(yreal, yprev) mean(abs(yreal - yprev))
eam_SES  <- eam(teste$Gold_Price, teste$SES)
eam_HOLT <- eam(teste$Gold_Price, teste$HOLT)
eam_HWad <- eam(teste$Gold_Price, teste$HW_ad)
eam_HWm  <- eam(teste$Gold_Price, teste$HW_mult)
eam_ETS  <- eam(teste$Gold_Price, teste$ETS)
eam_REG  <- eam(teste$Gold_Price, teste$REG)
acuracia <- tibble(
Modelo = c("SES", "HOLT", "HW Aditivo", "HW Multiplicativo", "ETS", "Regressão Linear"),
EAM = c(eam_SES, eam_HOLT, eam_HWad, eam_HWm, eam_ETS, eam_REG)
)
acuracia %>% arrange(EAM)
library(tidyverse)
library(forecast)
library(lubridate)
gold <- read_csv2("GoldUP.csv", show_col_types = FALSE)
indice_teste <- tail(1:nrow(gold), 12)   # últimos 12 meses (2024)
treino <- gold[-indice_teste, ]          # até dez/2023
teste  <- gold[indice_teste, ]           # jan–dez/2024
base_ts <- ts(treino$Gold_Price, frequency = 12, start = c(2015, 1))
autoplot(base_ts) +
labs(title = "Preço do Ouro (USD/oz)", x = "Ano", y = "USD/oz")
modelo_reg <- lm(Gold_Price ~ Crude_Oil + Interest_Rate + USD_INR + CPI,
data = treino)
summary(modelo_reg)
# Previsão com o modelo de regressão
prev_reg <- predict(modelo_reg, newdata = teste)
SES <- ses(base_ts, h = 12)
HOLT <- holt(base_ts, h = 12)
HW_ad <- hw(base_ts, seasonal = "additive", h = 12)
HW_mult <- hw(base_ts, seasonal = "multiplicative", h = 12)
ETS <- ets(base_ts)
ETS_pred <- forecast(ETS, h = 12)
teste <- cbind(
teste,
SES = SES$mean,
HOLT = HOLT$mean,
HW_ad = HW_ad$mean,
HW_mult = HW_mult$mean,
ETS = ETS_pred$mean,
REG = prev_reg
)
teste$Date <- as.Date(teste$Date)
ggplot(teste, aes(x = Date)) +
geom_line(aes(y = Gold_Price, color = "Real"), linetype = "solid") +
geom_line(aes(y = SES, color = "SES"), linetype = "dashed") +
geom_line(aes(y = HOLT, color = "Holt"), linetype = "solid") +
geom_line(aes(y = HW_ad, color = "HW Aditivo"), linetype = "dashed") +
geom_line(aes(y = HW_mult, color = "HW Multiplicativo"), linetype = "solid") +
geom_line(aes(y = ETS, color = "ETS"), linetype = "solid") +
geom_line(aes(y = REG, color = "Regressão Linear"), linetype = "dashed") +
scale_color_manual(name = "Modelos",
values = c("Real" = "black", "SES" = "blue", "Holt" = "green",
"HW Aditivo" = "orange", "HW Multiplicativo" = "purple",
"ETS" = "red", "Regressão Linear" = "brown")) +
theme_bw() +
labs(title = "Previsões do preço do ouro (jan–dez/2024)",
x = "Data", y = "USD/oz") +
theme(legend.position = "bottom")
library(tidyverse)
library(GGally)
library(broom)
df <- readr::read_csv("https://raw.githubusercontent.com/sillasgonzaga/curso_series_temporais/master/data/Bike-Sharing-Dataset/day.csv")
df_transf <- df %>% select(-c(instant, workingday)) %>%
rename(estacao = season, total = cnt, year = yr, month = mnth) %>%
mutate(weekday = weekday + 1) %>%
mutate(holiday = as.character(holiday)) %>%
mutate(year = lubridate::year(dteday),
month = str_pad(month, width = 2, side = "left", pad = "0"),
weathersit = factor(weathersit,
levels = 1:4,
labels = c("muito bom", "bom", "ruim", "muito ruim")),
weekday = factor(weekday,
levels = 1:7,
labels = c("Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab")),
estacao = factor(estacao,
levels = 1:4,
labels = c("Primavera", "Verao", "Outono", "Inverno")),
temp = temp * 41,
atemp = atemp * 50,
hum = hum * 100,
windspeed = windspeed * 67)
grafico <- ts(df_transf$total, start = c(2011, 1), frequency = 365)
autoplot(grafico)
library(forecast)
autoplot(mstl(grafico))
indice_teste <- tail(1:nrow(df_transf), 60)
treino <- df_transf[-indice_teste, ]  # modelo de treinamento
teste  <- df_transf[indice_teste, ]   # modelo de teste
# Ajuste do modelo
modelo.simples <- lm(total ~ month, data = treino)
summary(modelo.simples)
options(scipen = 999)
modelo.multiplo <- lm(total ~ estacao + year + month + weekday + weathersit, data = treino)
summary(modelo.multiplo)
forecast::checkresiduals(modelo.simples)
forecast::checkresiduals(modelo.multiplo)
# Previsao
prev.simples <- predict(modelo.simples, teste)
prev.mult <- predict(modelo.multiplo, teste)
# Grafico Previsao
teste <- cbind(teste,prev.simples,prev.mult)
library(ggplot2)
ggplot(teste, aes(x=dteday, y=total)) +
geom_line() +
geom_line(aes(y = prev.simples, color = "Regressao Simples"),
linetype = "dashed") +
geom_line(aes(y = prev.mult, color = "Regressao Multipla"),
linetype = "dashed") +
scale_color_manual(name = NULL, values = c("blue", "red")) +
theme(legend.position = "bottom")
# Medidas de Qualidade de Ajuste
eam <- function(yreal, yprev) {
mean(abs(yreal-yprev))
}
eam(yreal = teste$total, yprev = teste$prev.simples)
eam(yreal = teste$total, yprev = teste$prev.mult)
rbind(forecast::CV(modelo.simples), forecast::CV(modelo.multiplo))
library(tidyverse)
library(forecast)
library(lubridate)
gold <- read_csv2("GoldUP.csv", show_col_types = FALSE)
indice_teste <- tail(1:nrow(gold), 12)   # últimos 12 meses (2024)
treino <- gold[-indice_teste, ]          # até dez/2023
teste  <- gold[indice_teste, ]           # jan–dez/2024
base_ts <- ts(treino$Gold_Price, frequency = 12, start = c(2015, 1))
autoplot(base_ts) +
labs(title = "Preço do Ouro (USD/oz)", x = "Ano", y = "USD/oz")
modelo_reg <- lm(Gold_Price ~ Crude_Oil + Interest_Rate + USD_INR + CPI,
data = treino)
summary(modelo_reg)
# Previsão com o modelo de regressão
prev_reg <- predict(modelo_reg, newdata = teste)
SES <- ses(base_ts, h = 12)
HOLT <- holt(base_ts, h = 12)
HW_ad <- hw(base_ts, seasonal = "additive", h = 12)
HW_mult <- hw(base_ts, seasonal = "multiplicative", h = 12)
ETS <- ets(base_ts)
ETS_pred <- forecast(ETS, h = 12)
teste <- cbind(
teste,
SES = SES$mean,
HOLT = HOLT$mean,
HW_ad = HW_ad$mean,
HW_mult = HW_mult$mean,
ETS = ETS_pred$mean,
REG = prev_reg
)
teste$Date <- as.Date(teste$Date)
ggplot(teste, aes(x = Date)) +
geom_line(aes(y = Gold_Price, color = "Real"), linetype = "solid") +
geom_line(aes(y = SES, color = "SES"), linetype = "dashed") +
geom_line(aes(y = HOLT, color = "Holt"), linetype = "solid") +
geom_line(aes(y = HW_ad, color = "HW Aditivo"), linetype = "dashed") +
geom_line(aes(y = HW_mult, color = "HW Multiplicativo"), linetype = "solid") +
geom_line(aes(y = ETS, color = "ETS"), linetype = "solid") +
geom_line(aes(y = REG, color = "Regressão Linear"), linetype = "dashed") +
scale_color_manual(name = "Modelos",
values = c("Real" = "black", "SES" = "blue", "Holt" = "green",
"HW Aditivo" = "orange", "HW Multiplicativo" = "purple",
"ETS" = "red", "Regressão Linear" = "brown")) +
theme_bw() +
labs(title = "Previsões do preço do ouro (jan–dez/2024)",
x = "Data", y = "USD/oz") +
theme(legend.position = "bottom")
eam <- function(yreal, yprev) mean(abs(yreal - yprev))
eam_SES  <- eam(teste$Gold_Price, teste$SES)
eam_HOLT <- eam(teste$Gold_Price, teste$HOLT)
eam_HWad <- eam(teste$Gold_Price, teste$HW_ad)
eam_HWm  <- eam(teste$Gold_Price, teste$HW_mult)
eam_ETS  <- eam(teste$Gold_Price, teste$ETS)
eam_REG  <- eam(teste$Gold_Price, teste$REG)
acuracia <- tibble(
Modelo = c("SES", "HOLT", "HW Aditivo", "HW Multiplicativo", "ETS", "Regressão Linear"),
EAM = c(eam_SES, eam_HOLT, eam_HWad, eam_HWm, eam_ETS, eam_REG)
)
acuracia %>% arrange(EAM)
